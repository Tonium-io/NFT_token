
#!/bin/bash
set -e

tos=./tonos-cli
if test -f "$tos"; then
    echo "$tos exists."
else
    echo "$tos not found in current directory. Please, copy it here and rerun script."
    exit
fi

DEBOT_NAME=./RootTokenContractNF
giver=0:653b9a6452c7a982c6dc92b2da9eba832ade1c467699ebb3b43dca6d77b780dd
#giver=0:841288ed3b55d9cdafa806807f02a0ae0c169aa5edfe88a789a6482429756a94
function giver {
./tonos-cli --url $NETWORK call --abi ./grant.abi.json $giver grant "{\"addr\":\"${1:2}\"}"
#./tonos-cli --url $NETWORK call --abi ./local_giver.abi.json $giver sendGrams "{\"dest\":\"$1\",\"amount\":10000000000}"
}
function get_address {
echo $(cat log.log | grep "Raw address:" | cut -d ' ' -f 3)
}
function genaddr {
./tonos-cli genaddr $1.tvc $1.abi.json  > log.log
}

LOCALNET=http://127.0.0.1
DEVNET=https://net.ton.dev
MAINNET=https://main.ton.dev
NETWORK=$DEVNET

CODE=te6ccgECdQEAGAEAAij/ACDBAfSkIFiS9KDgXwKKIO1T2QkBAQr0pCD0oQIB4qAAAAABINdLgQIHIgG8IcICjlvtQAPT/yDXSyHBLI4vXwP6QCDXS8AA8tBDMNTRBe1QVQEwVQEwVQYwVQYwVQYwVQYwVQYwVQYwVQYwVQEgWQFVAeFxErry4EMBwADy4EIB1SJwVREBVREBVQPZUSGwAwE6joDhMAPU1NMH0/8ncF9QVRtVFgFVJVVIVRtVDdkEAVqBAQckAbyOIlvT/yDXS4EBACIBuSvhcbry4EPAAPLgQtUpcFURAVURAdlRErAFATqOgOEF1NTTByhwXzBVGlUaAVUWAVUHVThVGlUM2QYBVCTCB44iW9MHINdLgQEAIgG5KOFxuvLgQ8AA8uBC1SZwVREBVREB2VETsAcBOI6A4QbU1ChwXyBVGVUZAVUFVQpVC1UpVRlVC9kIAPyOHdQg10shwQgm4XG68uBDwADy4ELVJHBVEQFVEQHZjlaOGDAH1CDXSyDAAPLQQ3G6AcAAsCnh1TEo2Y4ncRe6B8AAUAewJXBwVQVVAVUGVQJVFVUXVRfhCNUxKAFVYVUIVQjZJ8EClyfAAiJVAeLhJ8AA8tBD2SQB4QfUKNkCASBPCgIC/U0LAgEgTgwBBTTAIA0BMI6AAsAAmXBwIwFVEVUC2eCBAgDXGHEj2Q4BBiHTAA8BKo6AAsAAmXBwI1URAVUR2eDT/3Ej2RABLG3tQAbDAAPTP9Mf0x+VAe1Q2zAiwRQRAgyOgOEiwRAmEgIMjoDhIsEMHxMByo6A4QLAC/KpBvKoBPLgRFsG+QFAc/kQwADyaO1E0NMAMMAA8n74AHD4ZPAByFEizsxwEs8LAHAhAc8LHxr0AMkBzMlwGc8LPxXME8zLB8v/y/8TzMntVIALVQEwVQIwVQIwVQHZFAH8IsEPjnXtRNDTAAHAAPK/cPhkD9DTAQHAAsgB8rBzIQHPCwFwIgHPCwHJ0AHOAvpAMFACzoAPcRLPC2GADxPPCx+AEWHTP9QwUALMyVADzMlw+wAxVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQIwVQIwVQIwAdnhAsAMFQFi8qkG8qgE8uBEMAf5AVQQhPkQwADyaO1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTABYBNI6AAsAAnHBwI3BVAQFVElUD2eD6QNN/cSTZFwFSLlYVvg/DAFAPsAHTHwLyfPgjgQPoqIIBhqCgVhUBuSDyvHD4ZFYR10sYAdiOgIEDpyMBvI5WIsEsjiUwgBRh+kAg10uBAIAiAbkl4XG68uBDwADy4ELVI3BVEQFVEQHZIFkBVQHhcRO68uBDAsAA8uBCgBNh1SJwVQGAEXZjgBRhgBNhcoAVY4AWYdnhgBRh+kAicHBVAdkZARhb038g10uBAIAiAbkaAUKOgCBZAVUB4XESuvLgQwHAAPLgQgHVInBVEQFVEQFVA9kbAWxfAwj0BHBVB4AcYVUB4wQJ03/RVhiAEmG68uBkJNMBIcEDmDDAA/LQY/I04QHAAvK00wABwAAcASCOgCBZAVUB4AH6BDEhVQHZHQH8MNIH0/8wwADy0G/4APgPgQCAU1RVAfQOb6HAAPLQZch2IQHPCwNwIgHPCwHJ0AHOGM6ADhjPCx8mAct/VhoBy/9Qc/oCAsmAF2HAAIAcYVUD9ABw+gJw+gJxzwthEszJc/sAgQCARUD0W8MAcbDIcCEBzwsAUczLP4AXYQHMHgD2gBJhIs5Qw6GAEWFVAsyAFGFVC8yAE2EByweAEmEBy/+AE2EBy/+OLTBQLMsfE/QAyVACzMlQCczJ7VSADDExMTExMTExMTExMTFVATBVAjBVAjAB2Sch4HEVzwsAH84dy38icHBVHFUEVVhVCVUNVQpVDFUeAVUPVQ/ZAQYiwRIgAv6OgOECwRGOdO1E0NMAAcAA8r9w+GQO0NMBAcACyAHysHMhAc8LAXAiAc8LAcnQAc4C+kAwUALOgBFxEs8LYYARE88LH1UP0z/U1NMHMFAEywfJUAXMyXD7AFsxMVUBMFUBMFUBMFUBMFUBMFUBMFUBMFUCMFUCMFUCMAHZ4e1EIiEA3tDTAAHAAPK/cPhkDtDTAQHAAsgB8rBzIQHPCwFwIgHPCwHJ0AHOAvpAMFACzoAQcRLPC2GAEBPPCx9VD9M/1NQwUAPMyVAEzMlw+wAwMTFVATBVATBVATBVATBVATBVATBVATBVAjBVAjBVAjAB2QH+AsETjnntRNDTAAHAAPK/cPhkDtDTAQHAAsgB8rBzIQHPCwFwIgHPCwHJ0AHOAvpAMFACzoATcRLPC2GAExPPCx9VD9M/1NTTB9P/0/8wUAbL/8lQB8zJcPsAXwQxMVUBMFUBMFUBMFUBMFUBMFUBMFUBMFUCMFUCMFUCMAHZ4SMBPO1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTAAHAACQB/o5vcPhkMIAYYdDTAQHAAsgB8rBzIQHPCwFwIgHPCwHJ0AHOAvpAMFACznHPC2GAEoASE88LHwPTHzBQA8t/yVACzMlw+wAxMTExMTExMTExMVUBMFUBMFUBMFUBMFUBMFUBMFUBMFUCMFUCMFUCMAHZIFkBVQHgAfpA038xMSElAAZVAdkBBiLBFycCDI6A4SLBFTMoAv6OgOHtRNDTAAHAAPK/cPhkD9DTAQHAAsgB8rBzIQHPCwFwIgHPCwHJ0AHOAvpAMFACzlUP0z/UgBRxFc8LYYAUFs8LHwHU0wfT/9P/1fpAMFAGzslQCczJcPsAXwYxVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQIwVQIwKikAClUCMAHZAQYCwRYrAjyOgOHtRNDTAAHAAPK/0z/U1NMH0//T/9X6QNTV0wAuLAHcjmmAGmHQ0wEBwALIAfKwcyEBzwsBcCIBzwsBydABzgL6QDBQAs6AFXESzwthgBUTzwsfFM4Sy3/JAczJcPsAMTExMTExMTExMTExVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQIwVQIwVQIwAdkCwAAtAE6OGnBw+GTIgQQAzwsKcM8L/8nQVQEwIlkBVQHZ4HD4ZPpA038wItkBPO1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTAAHAAC8BJo6AIFkBVQHgAfpA038xMSFVAdkwAUhw+GQwC9N/MAvTH1EcvAH0BDAB8uBAgQCAIQH0hm+hb6EuwgAxAfCOal8EgBph0NMBAcACyAHysHMhAc8LAXAiAc8LAcnQAc4C+kAwUALOcc8LYYAWgBYTzwsfE8t/yVACzMlw+wAxMTExMTExMTExMTExVQEwVQEwVQEwVQEwVQEwVQEwVQEwVQIwVQIwVQIwAdkgcHBVEgFVA+EDwAAyAKSOTgHy0ECBAIBTV1UB9HxvoW+hUXdZ4wRxVhQBvI4dAsAAgBFhpSJwVQFVxnKAEmMBVQ9ygBJjAYATYdlVAjBVAzAlVQJVBFUGVQVVBlUk4iDZAQYiwRk0AgyOgOECwRg9NQJgjoDh7UTQ0wABwADyv9M/1NTTB9P/0//V+kDU1dMAjhDIgQQAzwsKcM8L/8nQMSHZODYB/o5mgBlh0NMBAcACyAHysHMhAc8LAXAiAc8LAcnQAc4C+kAwUALOcc8LYYAXgBcTzwsfE87JUALMyXD7ADExMTExMTExMTExMVUBMFUBMFUBMFUBMFUBMFUBMFUBMFUCMFUCMFUCMAHZA8AAnnD4ZDEgAVWTVRsBVQzZ4HD4ZA03ACDTfzAB+kDTfzBQArotIwHiAWQG8qgE8uBEMAf5AVQQhPkQwADyaO1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTAAHAADkBJo6AIFkBVQHgAfpA038xMSFVAdk6AWowKlYRvgvDAFALsArTH/QEMAvyfPgjgQPoqIIBhqCgVhEBuXAhgBNhVQHjBAHyvHD4ZC3XSzsB/o54W9N/0VYSVQu68uBkIMAA8tBu+AD4D4EAgCFWEVUB9A5vocAA8tBlyHEhAc8LABTOEst/F8sfH/QAUY7OcB/PCwBQfswHyVAHzMlQLMs/GswYzBbLBxTL/xnL/xbMye1UgBgxMTExMVUBMFUBMFUCMFUCMFUCMAHZgQOnIwE8AMC8jlIiwSyOJDBVD/pAINdLgQCAIgG5JeFxuvLgQ8AA8uBC1SNwVREBVREB2SBZAVUB4XETuvLgQwLAAPLgQg/VVhBwVQFVxFUPVQ6AEWGAEmGAEmHZ4VUP+kAicHBVAdkBBiLBGz4Cbo6A4QLAGfKpBvKoBPLgRDAH+QFUEIT5EMAA8mjtRNDTAAHAAPK/0z/U1NMH0//T/9X6QNTV0wBKPwE0joACwACccHAjcFUBAVUSVQPZ4PpA039xJNlAAVguVhW+D8MAUA+wAdMfAvJ8+COBA+ioggGGoKBWFQG5IPK8cPhkVhHXSyHBLEEBWI6AIFkBVQHhcRK68uBDAcAA8uBCgBJh1SJwVQGAEXVjgBRhcoATYwGAFWHZQgEaXwOAEWH6QCDXSyHBLEMBQo6AIFkBVQHhcRK68uBDAcAA8uBCAdUicFURAVURAVUD2UQBGl8D+kAg10uBAIAiAblFAUKOgCBZAVUB4XESuvLgQwHAAPLgQgHVInBVEQFVEQFVA9lGASxwVQaAG2FVAeMEBNN/INdLgQCAIgG5RwFCjoAgWQFVAeFxErry4EMBwADy4EIB1SJwVREBVREBVQPZSAH8XwMJ9AQwCdN/0VYYgBJhuvLgZCHAAPLQbvgAyHYhAc8LA3AiAc8LAcnQAc6AGhLPCx8YzhLLf1B2zgXJgBRhwABQZ/oCgBhhAfQAcPoCcPoCcc8LYRXMyXP7AMhwIQHPCwBRRMs/UeHOHcyAEmFVDcyAEWEBzFUPAcsHH8v/SQCoVQ8By/+OKjBQY8sfFvQAyVAMzMlQC8zJ7VSAGTExMTExMTExMTFVATBVAjBVAjAB2SYh4HEezwsAGs4Yy38rcHBVG1ULVRhVGlUpVRlVDFUNVQ3ZAXICwBvyqTAF8qgwAvLgRDAF+QFUEGL5EMAA8mjtRNDTAAHAAPK/0z/U1NMH0//T/9X6QNTV0wABwABLAf6OcjBTrr4LwwBQC7AK0x/0BDAL8nz4I4ED6KiCAYagoC8BuXAhgBFhVQHjBAHyvHD4ZFLHuvLgZPgAyFFEzhPMcBTPCwBRIssfGvQAyVACzMkDzws/FswUzBLLB8v/FMv/E8zJ7VSAGzExMVUCMFUCMFUB2SBZAVUB4AH6QNN/TAAMMTEhVQHZAgEgTk4ABTyNoAEy3wHQ0wABwADysCDWAdMAlu1A7VDbMALAAFAClo6A4DAD0h8BwP/4APLgaNMfIcEamzDAGvLgaHAxMQHZ4QHADvLgaNN/MCDAAPLQae1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTAFRRATSOgALAAJxwcCNwVQEBVRJVA9ng+kDTf3Ek2VIB/AHTH/QEiwiBAIABgBNhVQNVAvQeb6HAAHGwyFHMznAtAc8LAIAUYSHLP1BzoFDMzIASYVUBzIARYQHMVQ8Bywcfy/8dy/+OITBQk8sfGPQAyVALzMlQCszJ7VRwMTExMTExMTExMTEB2SUh4XEczwsAF84Vy38pcHBVGQFVClMAIFUmVQZVCFUHVRkBVQtVC9kBjjAj1w0fb6PAAJ5wMTFVATBVATBVATAB2eAwJNdJwADycMAAnHBVATBVATBVATAB2eBtBNMfnnAxMVUBMFUBMFUBMAHZIsEaVQIMjoDhIsENZVYBoo6A4QLACyLh7UTQ0wAwwADyfvgAcPhk8AHIUSLOzHASzwsAcCEBzwsfHPQAyQHMyXAbzws/FcwTzMsHy//L/xXMye1UgAtVATBVATBVATAB2VcBBiLBDlgCPI6A4e1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTAF5ZATSOgALAAJxwcCNwVQEBVRJVA9ng+kDTf3Ek2VoBWIAUYdMA0wDTAPpAMCsBxwVw+GTAAIAUYdN/MAbTH/QEMALy0GYmwAD4APgPWwF4joAgWQFVAeCBAIBTg1UB9A5vocAA8uBtiwiBAIABVQlVBVUC9B5vocAAcbAVoFUBMCJVFgFVJVUkVQfZXAH+yHAhAc8LAIAWYSHLP4AWYQHMgBVhAcxVDyPOVQ8BzAGAE2HPCweAEmEBy/8KwACAEWFVCsv/jiswUGPLHxb0AMlQBczJUATMye1UgA0xMTExMTExMTExMTExMVUBMFUBMAHZIiHgcRbPCwAezhzLfyNwcFVJVQtVHFUMVQlVG10AFAFVC1UOVQ5VDtkBQALADiLh7UTQ0wABwADyv9M/1NTTB9P/0//V+kDU1dMAXwE0joACwACccHAjcFUBAVUSVQPZ4PpA039xJNlgAfJw+GTIcCEBzwsAcCEBzwsfgBZh0wCAGGFVAvQAUsXOAdMA0wD6QDAI0x9S5cwE9AQwCdMBgBhh038KyXEqAc8LAQjMyXAazws/VhgBzFYXAcxWFgHLB1YVAcv/CtP/MFAKy/8YzMlS9sxxzwsAFcxwzwsAyfkAJMEDYQEsmV8EwAPy0GPyNOEEwALytAXTAAHAAGIBII6AIFkBVQHgAfoEMSFVAdljAdow0gfT/zBQBLry4GdfBCHAAPLQbvgA+A+BAIBTJFUB9A5vocAA8uBtiwiBAIABVQNVBVUC9B5vocAAyHESsHAiAc8LAIAUYSHLP1HjzlByoFDMzIASYVUMzIARYQHMB8AAVQ9VB8sHH8v/Hcv/ZACGjiQwUKXLHxL0AMlQCszJUALMye1UgA4xMTExMTExMTExVQEwAdkuIeBxE88LABjOFst/JXBwVRVVJF4QVRRVF1UI2QEGIsEcZgJGjoDhAsAaIuHtRNDTAAHAAPK/0z/U1NMH0//T/9X6QNTV0wBqZwE0joACwACccHEjcFUCAVUDVRLZ4PpA039wJNloAfz4AA/6QHD4ZNN/MALTH/QEMIARYfLQaoAUYdMA0wDTAPpAMFAJxwXAAPLQa1sjwADy0G5SRLry4GyBAIBTQ1UB9A5vocAA8tBlyHYhAc8LA3AiAc8LAcnQAc4UzoAOFM8LHyUBy38sAcv/cBT6AgPJgBVhVQP0AHD6AnD6AnFpAJ7PC2HMyYBA+wCBAIBEMPRbwwBxsBOhyHAhAc8LAFEiyx8U9ADJUIPOFszMyVDFyz8azBjMFssHFMv/Esv/EszJ7VSAGjExMTExMVUBMAHZAQYiwR1rAjyOgOHtRNDTAAHAAPK/0z/U1NMH0//T/9X6QNTV0wBvbAE0joACwACccHEjcFUCAVUDVRLZ4PpA039wJNltAf5w+GTIcCEBzwsBgBJh0x8wIssfBNMfUhbLf3YUzwsDAsnQgBdh0wAH9AQwB9MA0wBQRs4GyQX6QDBQBs5w+gKAGWEB9ABw+gJw+gJxzwthFMzJgED7AMhwIQHPCwCAFGEhyz9R4s4dzIATYVUNzIASYQHMgBFhAcsHVQ8By/8fbgCQy/+OJjBQPMsfFvQAyVAMzMlQCczJ7VSAHDExMTExMTExMTExMVUBMAHZJyHgcRPPCwAazhjLfydwcFUSAVUrVUdVGVUcVQ3ZAUACwB0i4e1E0NMAAcAA8r/TP9TU0wfT/9P/1fpA1NXTAHABNI6AAsAAnHBwI3BVAQFVElUD2eD6QNN/cSTZcQFMAdMfVQ/TH9N/cPhkMFMDuQP0BDAD8uBAgQCAIwH0hm+hb6EjwgByAbKOgCBwcFUSAVUD4QPAAI5HAfLQQIEAgFNZVQH0fG+hb6FRd1njBHEpAbyOFwLAAAalIXBVAVUVVRUBVQRVB1UHVQfZVQIwVQMwJVUCVQRVBlUFVQZVJOIg2XMB+Mh2IQHPCwNwIgHPCwHJ0AHOgB1h0wDTANMA+kAwUATOUMTLHxjLf3AT+gICyQ3AAIAeYVUC9ABw+gJw+gJxzwthHczJgED7AMhwIQHPCwCAGmEhyz+AFGEjzoAUYQHMgBlhVQHMgBhhAcyAF2EByweAFmEBy/+AFWEBy/90ALiOKzBQ4ssfHPQAyVAMzMlQCszJ7VSAHTExMTExMTExMTExMTExMTExVQEwAdlWECHgcRXPCwCAEmEBzoARYQHLfyRwcFUecoARY1VrgBFhVRtVDlUfgBJhgBJh2Q==

echo GENADDR DEBOT
genaddr $DEBOT_NAME
DEBOT_ADDRESS=$(get_address)

echo ASK GIVER
giver $DEBOT_ADDRESS
DEBOT_ABI=$(cat $DEBOT_NAME.abi.json | xxd -ps -c 20000)

echo DEPLOY DEBOT $DEBOT_ADDRESS
#'{"Jurrors": ["0xf66a20b278b2064684b56c99baa5e2703ff7724617148a7a380fbd2133d866a4","0xf66a20b278b2064684b56c99baa5e2703ff7724617148a7a380fbd2133d866a3"], "TimeFinish": 1617942836}'



./tonos-cli --url $NETWORK deploy $DEBOT_NAME.tvc "{\"name\":\"5423\",\"symbol\":\"5423\",\"decimals\":0,\"root_public_key\":\"0xf66a20b278b2064684b56c99baa5e2703ff7724617148a7a380fbd2133d866a4\",\"wallet_code\":\"$CODE\",\"tokenURI\":\"5423\"}" --sign $DEBOT_NAME.keys.json --abi $DEBOT_NAME.abi.json
#./tonos-cli --url $NETWORK call $DEBOT_ADDRESS createNFTWallet "{\"root_token\":\"Some Addr\"}" --sign $DEBOT_NAME.keys.json --abi $DEBOT_NAME.abi.json

./tonos-cli --url $NETWORK call $DEBOT_ADDRESS mint "{\"tokenId\":\"1\",\"name\":\"5423\",\"data\":\"5423\",\"type\":0}" --sign $DEBOT_NAME.keys.json --abi $DEBOT_NAME.abi.json

echo DONE
echo $DEBOT_ADDRESS > address.log
echo debot  $DEBOT_ADDRESS
